<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <title>ประวัติเช็คชื่อห้องเน็ต</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            text-align: center;
            padding: 20px;
            overflow: hidden; /* ป้องกันไม่ให้เกิด scrollbar */
        }
        h1 {
            color: #333;
        }
        input[type="text"] {
            padding: 10px;
            margin: 10px;
            width: 300px;
        }
        button {
            padding: 10px 15px;
            margin: 10px;
            background-color: #28a745;
            color: white;
            border: none;
            cursor: pointer;
            transition: transform 0.2s;
        }
        button:hover {
            transform: scale(1.1);
        }
        table {
            margin: 20px auto;
            border-collapse: collapse;
            width: 80%;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #28a745;
            color: white;
        }
        tr:hover {
            background-color: #f1f1f1;
        }
        .snow {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            overflow: hidden;
        }
        .snowflake {
            position: absolute;
            top: -10px;
            color: white;
            font-size: 1em;
            opacity: 0.9;
            animation: fall linear infinite;
        }
        @keyframes fall {
            to {
                transform: translateY(100vh);
            }
        }
    </style>
    <script src="https://www.gstatic.com/firebasejs/9.1.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.0/firebase-database.js"></script>
    <script>
        // ตั้งค่าการเชื่อมต่อ Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyCsirKBE3O9HpO9YD9BoiVp8iua5NUFWDE",
            authDomain: "sample-firebase-ai-app-23a31.firebaseapp.com",
            databaseURL: "https://sample-firebase-ai-app-23a31-default-rtdb.firebaseio.com",
            projectId: "sample-firebase-ai-app-23a31",
            storageBucket: "sample-firebase-ai-app-23a31.appspot.com",
            messagingSenderId: "214209088155",
            appId: "1:214209088155:web:a854abf5ab5ae9b7a3543e"
        };

        // Initialize Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        function loadCheckIns() {
            const checkInsRef = database.ref('student-checkins');
            checkInsRef.on('value', (snapshot) => {
                const data = snapshot.val();
                const table = document.getElementById('checkinTable');
                table.innerHTML = ''; // Clear the table

                for (const key in data) {
                    const row = table.insertRow();
                    row.insertCell(0).innerText = data[key].StudentNumber;
                    row.insertCell(1).innerText = data[key].StudentName;
                    row.insertCell(2).innerText = data[key].CheckInTime;
                }
            });
        }

        function searchStudents() {
            const input = document.getElementById('searchInput').value.toLowerCase();
            const table = document.getElementById('checkinTable');
            const rows = table.getElementsByTagName('tr');

            for (let i = 1; i < rows.length; i++) {
                const cells = rows[i].getElementsByTagName('td');
                const studentName = cells[1].innerText.toLowerCase();
                rows[i].style.display = studentName.includes(input) ? '' : 'none';
            }
        }

        function createSnowflakes() {
            const snowContainer = document.createElement('div');
            snowContainer.classList.add('snow');
            document.body.appendChild(snowContainer);

            for (let i = 0; i < 100; i++) {
                const snowflake = document.createElement('div');
                snowflake.classList.add('snowflake');
                snowflake.innerHTML = '❄';
                snowflake.style.left = Math.random() * window.innerWidth + 'px';
                snowflake.style.animationDuration = Math.random() * 3 + 2 + 's';
                snowflake.style.fontSize = Math.random() * 1 + 0.5 + 'em';
                snowContainer.appendChild(snowflake);
            }
        }

        window.onload = function() {
            createSnowflakes();
            loadCheckIns();
        }
    </script>
</head>
<body>
    <h1>ประวัติเช็คชื่อห้องเน็ต</h1>
    <input type="text" id="searchInput" placeholder="ค้นหาชื่อนักเรียน" onkeyup="searchStudents()">
    <button onclick="loadCheckIns()">โหลดประวัติการเช็คชื่อ</button>
    <table border="1" id="checkinTable">
        <tr>
            <th>เลขที่นักเรียน</th>
            <th>ชื่อนักเรียน</th>
            <th>เวลาเช็คชื่อ</th>
        </tr>
    </table>
</body>
</html>
